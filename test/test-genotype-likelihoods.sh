source ./check.sh

gemini query -q "select gt_phred_ll_homref.A, gt_phred_ll_het.A, gt_phred_ll_homalt.A, gt_phred_ll_homref.B, gt_phred_ll_het.B, gt_phred_ll_homalt.B from variants" test.PLs.db > obs
echo "561	0	317	0	99	1176
142	0	251	34	0	311
0	247	2833	744	0	2519
1119	0	3133	438	0	4373
3658	0	2804	1456	0	4749
45	3	0	-1	-1	-1
45	3	0	-1	-1	-1
41	3	0	-1	-1	-1
None	None	None	None	None	None" > exp

check obs exp "GLs.t01"


gemini query -q "select (gt_phred_ll_homref).(*) from variants limit 2" test.PLs.db > obs

echo "561	0	0	0	282	360	0	0	0	137	0	401
142	34	57	404	46	207	99	49	-1	-1	46	37" > exp

check obs exp "GLs.t02"

gemini query --header -q "select (gt_phred_ll_homref).(*) from variants" --gt-filter "(gt_phred_ll_homref).(*).(>=20).(all)" test.PLs.db > obs

echo "gt_phred_ll_homref.A	gt_phred_ll_homref.B	gt_phred_ll_homref.C	gt_phred_ll_homref.D	gt_phred_ll_homref.E	gt_phred_ll_homref.F	gt_phred_ll_homref.G	gt_phred_ll_homref.H	gt_phred_ll_homref.I	gt_phred_ll_homref.J	gt_phred_ll_homref.K	gt_phred_ll_homref.L
1119	438	87	583	383	125	755	88	1649	201	161	103" > exp


check obs exp "GLs.t03"

<<GENOTYPES
0/1:44,29:70:99:561,0,317	0/0:56,0:56:99:0,99,1176	0/0:158,0:158:99:0,280,3426	0/0:91,2:91:78:0,78,892	0/1:28,12:38:99:282,0,254	0/1:41,17:56:99:360,0,494	0/0:35,0:35:48:0,48,572	0/0:47,0:47:42:0,42,491	0/0:21,0:21:15:0,15,150	0/1:18,6:23:99:137,0,171	0/0:47,1:47:66:0,66,748	0/1:30,16:44:99:401,0,154
0/1:5,3:9:99:142,0,251	0/1:6,1:7:34:34,0,311	0/1:16,2:18:57:57,0,803	0/1:5,8:13:99:404,0,238	0/1:2,1:5:46:46,0,51	0/1:1,4:5:19:207,0,19	0/1:2,2:4:77:99,0,77	0/1:1,1:2:49:49,0,49	./.:.:.:.:.	./.:.:.:.:.	0/1:2,1:3:46:46,0,102	0/1:5,1:6:37:37,0,259
0/0:245,5:239:99:0,247,2833	0/1:198,51:238:99:744,0,2519	0/1:106,144:238:99:3261,0,959	0/0:227,3:222:99:0,184,2148	0/0:105,1:103:99:0,159,1940	0/1:163,50:203:99:898,0,1851	0/1:64,36:95:99:842,0,192	0/1:47,67:109:45:1397,0,45	0/1:46,6:50:99:103,0,137	0/0:79,3:79:99:0,105,1241	0/1:103,33:130:99:525,0,1103	0/0:90,0:90:69:0,69,840
0/1:184,66:238:99:1119,0,3133	0/1:208,42:238:99:438,0,4373	0/1:219,31:238:87:87,0,5113	0/1:194,56:238:99:583,0,3872	0/1:211,37:236:99:383,0,3687	0/1:210,40:238:99:125,0,4458	0/1:142,46:179:99:755,0,1869	0/1:216,34:238:88:88,0,3878	0/1:77,66:136:63:1649,0,63	0/1:126,26:145:99:201,0,2385	0/1:210,40:238:99:161,0,3825	0/1:154,22:168:99:103,0,2315
0/1:113,135:236:99:3658,0,2804	0/1:170,80:238:99:1456,0,4749	0/0:218,32:238:65:0,65,6850	0/1:129,120:237:99:3479,0,2750	0/1:82,168:238:99:5081,0,1536	0/1:161,88:237:99:2326,0,4131	0/1:137,113:238:99:3063,0,3536	0/1:120,129:243:99:3505,0,3157	0/1:149,101:238:99:2614,0,3510	0/1:144,106:238:99:2902,0,3511	0/1:207,43:238:99:444,0,5850	0/1:120,127:241:99:3378,0,3064
1/1:0,2:2:3:45,3,0	./.:.:.:.:.	0/0:4,0:4:6:0,6,90	0/1:1,1:2:36:36,0,36	1/1:0,1:1:3:39,3,0	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	0/1:1,1:2:35:36,0,35	0/0:1,0:1:3:0,3,42
1/1:0,2:2:3:45,3,0	./.:.:.:.:.	./.:.:.:.:.	1/1:0,2:2:6:80,6,0	1/1:0,1:1:3:39,3,0	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	0/1:1,1:2:34:36,0,34	0/0:1,0:1:3:0,3,42
1/1:0,2:2:3:41,3,0	./.:.:.:.:.	./.:.:.:.:.	0/0:1,0:1:3:0,3,41	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	1/1:0,1:1:3:42,3,0	0/0:1,0:1:3:0,3,42
./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.	./.:.:.:.:.
GENOTYPES
